<?xml version="1.0"?>
<PropertyList>
    
    <logic>
        <name>Throttles at idle</name>
         <input>
            <and>
				<!-- engine 1 -->
				<or>
					<less-than>
						<property>/controls/engines/engine[0]/throttle</property>
						<property>/autopilot/autospoilers/config/idle-throttle</property>
					</less-than>
					<property>/controls/engines/engine[0]/reverser</property>
				</or>
				<!-- engine 3 -->
				<or>
					<less-than>
						<property>/controls/engines/engine[2]/throttle</property>
						<property>/autopilot/autospoilers/config/idle-throttle</property>
					</less-than>
					<property>/controls/engines/engine[2]/reverser</property>
				</or>
            </and>
        </input>
        <output>/autopilot/autospoilers/throttles-at-idle</output>
    </logic>
	
	<logic>
        <name>RTO sensed</name>
         <input>
            <or>
				<!-- engine 2 -->
				<and>
					<greater-than>
						<property>/controls/engines/engine[0]/throttle</property>
						<property>/autopilot/autospoilers/config/idle-throttle</property>
					</greater-than>
					<property>/controls/engines/engine[0]/reverser</property>
				</and>
				<!-- engine 4 -->
				<and>
					<greater-than>
						<property>/controls/engines/engine[2]/throttle</property>
						<property>/autopilot/autospoilers/config/idle-throttle</property>
					</greater-than>
					<property>/controls/engines/engine[2]/reverser</property>
				</and>
            </or>
        </input>
        <output>/autopilot/autospoilers/rto-sensed</output>
    </logic>

    <logic>
        <name>Airborne</name>
        <input>
			<or>
				<not><property>/gear/gear[1]/wow</property></not>
				<not><property>/gear/gear[2]/wow</property></not>
				<not><property>/gear/gear[3]/wow</property></not>
				<not><property>/gear/gear[4]/wow</property></not>
			</or>
        </input>
        <output>/autopilot/autospoilers/airborne</output>
    </logic>
	
	<filter>
        <name>Speedbrake lever</name>
        <type>gain</type>
        <gain>1.0</gain>
		<!-- Speedbrake lever stop, prevents it from moving to UP in air -->
		<input>
			<condition>
				<and>
					<equals>
						<property>/autopilot/autospoilers/step</property>
						<value>3</value>
					</equals>
					<property>/autopilot/autospoilers/airborne</property>
				</and>
            </condition>
			<value>0</value>
        </input>
		<!-- Arm -->
		<input>
			<condition>
				<and>
					<equals>
						<property>/autopilot/autospoilers/step</property>
						<value>1</value>
					</equals>
					<property>/autopilot/autospoilers/throttles-at-idle</property>
					<not><property>/autopilot/autospoilers/airborne</property></not>
				</and>
            </condition>
			<value>3</value>
        </input>
		<!-- RTO -->
		<input>
			<condition>
				<and>
					<equals>
						<property>/autopilot/autospoilers/step</property>
						<value>0</value>
					</equals>
					<property>/autopilot/autospoilers/rto-sensed</property>
					<not><property>/autopilot/autospoilers/airborne</property></not>
				</and>
            </condition>
			<value>3</value>
        </input>
		<!-- Go-around -->
		<input>
			<condition>
				<and>
					<equals>
						<property>/controls/flight/speedbrake</property>
						<value>1</value>
					</equals>
					<not><property>/autopilot/autospoilers/throttles-at-idle</property></not>
				</and>
            </condition>
			<value>0</value>
        </input>
		<!-- default input -->
        <input>
			<property>/autopilot/autospoilers/step</property>
        </input>
        <output>/autopilot/autospoilers/step</output>
    </filter>
    
    <!-- output summer -->
    <filter>
        <name>Output Summer</name>
        <type>gain</type>
        <gain>1.0</gain>
		<input>
			<condition>
				<equals>
					<property>/autopilot/autospoilers/step</property>
					<value>0</value>
				</equals>
            </condition>
			<value>0</value>
        </input>
		<!--<input>
			<condition>
				<equals>
					<property>/autopilot/autospoilers/step</property>
					<value>2</value>
				</equals>
            </condition>
			<value>0</value>
        </input>-->
        <input>
			<condition>
				<equals>
					<property>/autopilot/autospoilers/step</property>
					<value>3</value>
				</equals>
            </condition>
			<value>1</value>
        </input>
        <!-- default input -->
        <input>
			<property>/controls/flight/speedbrake</property>
        </input>
        <output>/controls/flight/speedbrake</output>
    </filter>
        
</PropertyList>